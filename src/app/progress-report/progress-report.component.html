
<div class="container">
    <div class="row  border bg-light  p-3">
            <!-- <div class="col-lg-2"><b class="mt-1">Select date range</b> </div> -->
            <div class="col-lg-6  groupbody">
                <label class="font-weight-bold ml-3"> Select Date Range</label>
                <div class="input-group">
                        <div class="col-lg-6 p-0">
                            <div class="dp-hidden position-absolute" style="width: 65%;">
                                <div class="input-group">
                                    <input name="datepicker" class="form-control" ngbDatepicker #datepicker="ngbDatepicker"
                                        [autoClose]="'outside'" (dateSelect)="onDateSelection($event,datepicker)" [displayMonths]="2" [dayTemplate]="t"
                                        outsideDays="hidden" [startDate]="fromDate!" tabindex="-1" />
                                    <ng-template #t let-date let-focused="focused">
                                        <span class="custom-day" [class.focused]="focused" [class.range]="isRange(date)"
                                            [class.faded]="isHovered(date) || isInside(date)" (mouseenter)="hoveredDate = date"
                                            (mouseleave)="hoveredDate = null">
                                            {{ date.day }}
                                        </span>
                                    </ng-template>
                                </div>
                            </div>
                            <div class="input-group">
                                <input #dpFromDate class="form-control" placeholder="DD/MM/YYYY" name="dpFromDate"
                                    [value]="formatter.format(fromDate)" (input)="fromDate = validateInput(fromDate, dpFromDate.value)" />
                                <button class="btn btn-outline-secondary bi bi-calendar3" (click)="datepicker.toggle()"
                                    type="button"><i class="fas fa-calendar"></i></button>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="input-group">
                                <input #dpToDate class="form-control" placeholder="DD/MM/YYYY" name="dpToDate"
                                    [value]="formatter.format(toDate)" (input)="toDate = validateInput(toDate, dpToDate.value)" />
                                <button class="btn btn-outline-secondary bi bi-calendar3" (click)="datepicker.toggle()"
                                    type="button"><i class="fas fa-calendar"></i></button>
                            </div>
                        </div>
                    

            
                </div>
            
            </div>
            <div class="col-lg-6 p-0">
                <label class="font-weight-bold ml-1" > Select User</label>
                <input  placeholder="Enter user name" id="documenttypeSelect" [(ngModel)]='treename' type="text"
                    (keyup)="getepople($event)" class="form-control col" />
                <!-- <span *ngIf="loder"><i class=" ml-2 fa fa-spinner fa-spin fa-lg"></i></span> -->
                <ul id="search-results" class="list-group" *ngIf="showdocument"
                    style="cursor: pointer; height: 67vh;overflow-x: scroll;position: fixed;">
                
                    <li *ngFor="let user of states" class="list-group-item">
                
                        <span (click)="selecteduser(user)">{{user.firstMetadataValue('eperson.firstname')+ ' '+user.firstMetadataValue('eperson.lastname') }} ({{user.email}})</span>
                    </li>
                    <li *ngIf="states.length==0 && !loderepople">
                        <strong>No use(s) Found </strong>
                    </li>
                    <li *ngIf="states.length==0 && loderepople">
                        <ds-loading></ds-loading>
                    </li>
                </ul>
            </div>
            </div>
<div class="row  border bg-light  p-3">
            <div class="col-lg-6 p-0">
                <label class="font-weight-bold ml-1"> Select Action Type</label>
                <select class="form-control col" id="actiontype" (change)="selectedaction($event)" name="actiontype" placeholder="">
                    <option value="">Select Action type</option>
                    <option value="0">Login</option>
                    <option value="1"> View Document</option>
                    <option value="2">View Merge Document</option>
                    <option value="3">Download</option>
                    <option value="4">Edit</option>
                    <option value="5">Delete</option>
                    <option value="6">Merge PDF</option>
                    
                </select>
            </div>
            <div class="col-lg-1 mt-4"></div>
            <div class="col-lg-3 mt-4"><button class="btn btn-primary" (click)="getresult()" style="    width: 150px;">View</button></div>
            <div class="col-lg-2 mt-4" ><button class="btn btn-primary"  (click)="downloadEXsl()" style="display: none;   width: 150px;">Download</button></div>
        
    </div>
    <div class="row mt-4">
        <ds-loading *ngIf="loder"></ds-loading>
        <ds-pagination *ngIf="(pageInfoState$ | async)?.totalElements > 0 && !loder" [paginationOptions]="config" 
            [pageInfoState]="pageInfoState$" (pageChange)="onPageChange($event)"
            (pageSizeChange)="onPageSizeChange($event)" [collectionSize]="(pageInfoState$ | async)?.totalElements" [hideGear]="false"
            [hidePagerWhenSinglePage]="true" style="width:100%">
            <div class="table-responsive">
                <table id="epeople" class="table table-striped table-bordered">
                    <thead>
                        <tr>
                            <th scope="col">Sr.No</th>
                            <th>Title</th>
                            <th>Dspace Object</th>
                            <th scope="col">User Name</th>
                            <th scope="col">Action </th>
                            <th scope="col">Action Date</th>
                           
                            
                        </tr>
                    </thead>
                    <tbody>
                        
                        
                        <tr *ngFor="let item1 of (items$ | async)?.page; let i=index;"> 
                        <td>
                            {{(pageInfoState$ | async)?.elementsPerPage * ((pageInfoState$ | async)?.currentPage-1)+i+1}}
                            </td>
                            <td>{{item1.title}}</td>
                            <td>{{item1.dspaceObject}}</td>
                            <td><span *ngIf="item1.ePersonRest">{{item1.ePersonRest.name}}</span> </td>
                            <td>{{item1.action}}</td>
                            <td>{{item1.actionDate | date:'dd/MM/yyyy HH:mm:ss'}}</td>
                           </tr>
                    </tbody>
                </table>
            </div>
        </ds-pagination>
        <div *ngIf="(pageInfoState$ | async)?.totalElements == 0 && !loder" class="alert alert-info w-100 mb-2" role="alert">
           Data not found!
        </div>
    </div>
</div>